{{#if data.entries.length}}

{{#if (eq data.layout 'grid')}}

<div class="card">
  {{> dataNavigationHeader}}
  {{> dataNavigationFilters}}
  {{> dataNavigationFooter}}
</div>

{{#each data.entries as |entry|}}
{{/each}}

{{else}}

<div class="card">
  {{> dataNavigationHeader}}
  {{> dataNavigationFilters}}
  <div class="table-responsive">
    <table class="table table-vcenter card-table table-nowrap">
      <thead>
        <tr>
          <th></th>
          <th>Status Update</th>
          <th>File Upload</th>
          <th>Active Order</th>
          {{#each data.fields}}
          {{#if this.subscription}}
          <th class="text-danger fw-bold">{{this.actualName}}</th>
          {{else}}
          <th>{{this.actualName}}</th>
          {{/if}}
          {{/each}}
        </tr>
      </thead>
      <tbody>
        {{#each data.entries as |entry|}}
        <tr class="data-row {{#if (eq entry.isExpired 1)}}bg-blue-lt{{/if}}">
          <td>
            <a href="/entry/{{entry._id}}/project/{{../data.project.slug}}"
              class="btn btn-primary btn-icon cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="icon icon-tabler icons-tabler-outline icon-tabler-user m-0">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" />
                <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
              </svg>
            </a>
            <button class="btn btn-secondary-outline btn-icon edit-entry cursor-pointer" entry-id="{{entry._id}}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="icon icon-tabler icons-tabler-outline icon-tabler-pencil-plus m-0">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"></path>
                <path d="M13.5 6.5l4 4"></path>
                <path d="M16 19h6"></path>
                <path d="M19 16v6"></path>
              </svg>
            </button>
            <button class="btn text-red btn-icon cursor-pointer" entry-id="{{entry._id}}" onclick="deleteEntry(this)">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="icon icon-tabler icons-tabler-outline icon-tabler-trash-x m-0">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M4 7h16" />
                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                <path d="M10 12l4 4m0 -4l-4 4" />
              </svg>
            </button>
          </td>

          <td class="data-row">
            {{#if entry.latestStatusUpdate}}
              <div class="d-flex flex-column">
                <small class="text-muted">
                  {{#if (lte entry.latestStatusUpdate.daysSince 7)}}
                    <span class="text-green">{{entry.latestStatusUpdate.daysSince}} days ago</span>
                  {{else}}
                    <span class="text-orange">{{entry.latestStatusUpdate.daysSince}} days ago</span>
                  {{/if}}
                </small>
                {{#if entry.latestStatusUpdate.oldValue}}
                <small class="text-muted">
                  from: {{shortenString entry.latestStatusUpdate.oldValue 10}}
                </small>
                {{/if}}
              </div>
            {{else}}
              <span class="text-muted">No status updates</span>
            {{/if}}
          </td>

          <td class="data-row">
            {{#if entry.latestFile}}
              <div class="d-flex flex-column">
                <div class="d-flex align-items-center mb-1">
                  {{#if (startsWith entry.latestFile.mimeType "image/")}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon text-blue me-1">
                      <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
                      <circle cx="9" cy="9" r="2"/>
                      <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                    </svg>
                  {{else if (or (includes entry.latestFile.mimeType "pdf") (includes entry.latestFile.mimeType "document"))}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon text-red me-1">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                      <polyline points="14,2 14,8 20,8"/>
                      <line x1="16" y1="13" x2="8" y2="13"/>
                      <line x1="16" y1="17" x2="8" y2="17"/>
                      <polyline points="10,9 9,9 8,9"/>
                    </svg>
                  {{else}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon text-gray me-1">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                      <polyline points="14,2 14,8 20,8"/>
                    </svg>
                  {{/if}}
                </div>
                <small class="text-muted">
                  {{#if (lte entry.latestFile.daysSince 7)}}
                    <span class="text-green">{{entry.latestFile.daysSince}} days ago</span>
                  {{else}}
                    <span class="text-orange">{{entry.latestFile.daysSince}} days ago</span>
                  {{/if}}
                </small>
                <small class="text-muted">{{entry.latestFile.size}}</small>
              </div>
            {{else}}
              <span class="text-muted">No files uploaded</span>
            {{/if}}
          </td>

          <td class="data-row">
            {{#if entry.isPaid}}
            <span class="text-red">{{entry.customer.name}}</span>
            {{else}}
            <span >No order</span>
            {{/if}}
          </td>

          {{#each ../data.fields}}

          {{#if (eq this.type "boolean")}}
          {{#if (eq this.options.0.value (lookup entry this.name))}}
          <td> <span class="status status-green"> {{lookup entry this.name}}</span> </td>
          {{else}}
          <td> <span class="status status-red"> {{lookup entry this.name}}</span> </td>
          {{/if}}

          {{else if (eq this.type "dropdown")}}
          <td class="{{#if (neq @key 0)}}text-secondary{{/if}}">{{lookup entry this.name}}</td>

          {{else if (eq this.type "date")}}
          <td class="{{#if (neq @key 0)}}text-secondary{{/if}}"> {{formatDate (lookup entry this.name)}} </td>

          {{else if (eq this.type "image")}}
          {{#if (lookup entry this.name)}}
          <td>
            <a data-fslightbox="gallery" href="{{lookup entry this.name}}">
              <img class="img-thumbnai p-0 overflow-hidden rounded-3 border"
                src="{{resizeCloudinaryUrl (lookup entry this.name) 't_w-250'}}" alt="" style="max-width: 50px;">
            </a>
          </td>
          {{else}}
          <td>
            <a data-fslightbox="gallery" href="/static/images/no-image-placement.png">
              <img class="img-thumbnail p-0 overflow-hidden rounded-3 border"
                src="/static/images/no-image-placement.png" alt="" style="max-width: 50px;">
            </a>
          </td>
          {{/if}}

          {{else if (eq this.type "file")}}
          {{#if (lookup entry this.name)}}
          <td class="text-secondary">
            <a href="{{lookup entry this.name}}" target="_blank">Download File</a>
          </td>
          {{else}}
          <td class="{{#if (neq @key 0)}}text-secondary{{/if}}"> <span>No file uploaded</span> </td>
          {{/if}}

          {{else if this.subscription}}
          <td class="text-danger fw-bold">{{lookup entry this.name}}<sup class="ms-1">{{../../data.project.currency}} /
              Month</sup></td>
          {{else}}
          <td class="text-secondary"> {{shortenString (lookup entry this.name) 40}} </td>
          {{/if}}

          {{/each}}
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
  {{> dataNavigationFooter}}
</div>

{{/if}}

{{else}}

{{#if data.pagination.showSearchBar}}
<div class="card">
  {{> dataNavigationHeader}}
  {{> dataNavigationFilters}}
  {{> dataNavigationFooter}}
</div>
{{/if}}

{{/if}}